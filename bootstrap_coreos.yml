---
- name: reboot server into rescue image
  hosts: coreos
  connection: local
  gather_facts: no
  vars:
      ansible_python_interpreter: /usr/bin/python
  roles:
    - role: boot-rescue

- name: install coreos
  hosts: coreos
  user: root
  gather_facts: no

  roles:
    - role: etcd-certs-cfssl
    - role: extra-cas
    - { role: install-coreos,  ansible_python_interpreter: /usr/bin/python }
    - { role: ansible-coreos-bootstrap, ansible_ssh_user: core   }
    - { role: cloud-config, clear_etcd_data: true, ansible_ssh_user: core  }
    - { role: unsafe_reboot, unsafe_reboot_dealay: 1, ansible_ssh_user: core }
